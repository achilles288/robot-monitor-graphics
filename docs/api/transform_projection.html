<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Robot Monitor Graphics: Projection To The Screen</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js"></script>
<script type="text/javascript" src="../pages/api/header.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo_header.svg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Robot Monitor Graphics
   </div>
   <div id="projectbrief">Simple and quick 2D/3D graphics engine for simulation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('transform_projection.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Projection To The Screen </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><dl class="section user"><dt></dt><dd>After model transform and camera transform, we have the coordinates in camera space. For the projection transform matrix, we have to use one of these, orthographic projection or perspective projection.</dd></dl>
<h1>OpenGL Coordinate System</h1>
<div class="image">
<object type="image/svg+xml" data="clip_space.svg" style="pointer-events: none;"></object>
</div>
 <dl class="section user"><dt></dt><dd>In a vertex shader of the OpenGL API, the triangle coordinates are placed within -1 and 1 of xyz coordinates. This can be visualized as a clipping volume. Only the fragments within this volume is rendered on the screen. These coordinates are later transformed to the screen space as below.</dd></dl>
<div class="image">
<object type="image/svg+xml" data="screen_space.svg" style="pointer-events: none;"></object>
</div>
 <dl class="section user"><dt></dt><dd>The X-coordinate of -1 in the clip space means the left most part of the window and 1 the right most. The Z-coordinate is often called depth value. The fragment with greater depth value is rendered in front of other fragments.</dd></dl>
<dl class="section user"><dt></dt><dd>When defining a projection matrix, transform matricies to make the camera space fit in the clip space is to be considered.</dd></dl>
<h1>Orthographic Projection</h1>
<div class="image">
<object type="image/svg+xml" data="orthographic.svg" style="pointer-events: none;"></object>
</div>
 <dl class="section user"><dt></dt><dd>It is a form of parallel projection, in which all the projection lines are orthogonal to the projection plane, resulting in every plane of the scene appearing in affine transformation on the viewing surface.</dd></dl>
<dl class="section user"><dt></dt><dd>In this type of projection, the vectors transformed by the view matrix is almost directly used since all the light particles are parallel along the viewing direction.</dd></dl>
<dl class="section user"><dt></dt><dd>All we have to do is scaling and translation so that the vectors fit in the OpenGL clip space. In the world space, a near plane is defined at distance <em>n</em> and a far plane is defined at distance <em>f</em>.</dd></dl>
<p class="formulaDsp">
\[ P = \begin{pmatrix} s.aspect &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; s &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; A &amp; B \\ 0 &amp; 0 &amp; 0 &amp; 1 \end{pmatrix} \]
</p>
<dl class="section user"><dt></dt><dd>\(s\) is the uniform scaling factor in X and Y coordinates. \(aspect = {width \over height}\) is the aspect ratio of the viewport. The Z-scaling and Z-translation \(A\) and \(B\) are calculated as follow, </dd></dl>
<dl class="section user"><dt></dt><dd>\( \begin{pmatrix} A &amp;&amp; B \\ 0 &amp;&amp; 1 \end{pmatrix} \begin{pmatrix} z \\ 1 \end{pmatrix} = \begin{pmatrix} Az + B \\ 1 \end{pmatrix} \)</dd></dl>
<dl class="section user"><dt></dt><dd>\(z = -n \Rightarrow -An + B = 1 \) </dd></dl>
<dl class="section user"><dt></dt><dd>\(z = -f \Rightarrow -Af + B = -1 \)</dd></dl>
<p class="formulaDsp">
\[ A = {2 \over {f-n}} \qquad B = {{n+f} \over {f-n}} \]
</p>
<h1>Perspective Projection</h1>
<dl class="section user"><dt></dt><dd>In a projective projection, instead of the parallel lines, the light particles from the scene converge at a single point. At some focal length from the focus, the image is captured.</dd></dl>
<div class="image">
<object type="image/svg+xml" data="perspective.svg" style="pointer-events: none;"></object>
</div>
 <dl class="section user"><dt></dt><dd>From the above figure, applying similar triangles ratio, we have the following equations.</dd></dl>
<p class="formulaDsp">
\[ {{x&#39;} \over d} = {x \over z} \qquad {{y&#39;} \over d} = {y \over z} \]
</p>
<p class="formulaDsp">
\[ \begin{pmatrix} x&#39; \\ y&#39; \end{pmatrix} = \begin{pmatrix} {d \over z} \times x \\ {d \over z} \times y \end{pmatrix} \]
</p>
<dl class="section user"><dt></dt><dd>In matricies, the transform makes homogeneous coordinate and w coordinate no longer 1 and we must divide at the end.</dd></dl>
<p class="formulaDsp">
\[ P = \begin{pmatrix} 1 &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 1 &amp; 0 \\ 0 &amp; 0 &amp; -{1 \over d} &amp; 0 \end{pmatrix} \]
</p>
<dl class="section user"><dt></dt><dd>To verify it with above equations, </dd></dl>
<dl class="section user"><dt></dt><dd>\( P \begin{pmatrix} x \\ y \\ z \\ 1 \end{pmatrix} = \begin{pmatrix} x \\ y \\ z \\ -{z \over d} \end{pmatrix} \rightarrow \begin{pmatrix} {d \times x} \over {-z} \\ {d \times y} \over {-z} \\ -d \\ 1 \end{pmatrix} \)</dd></dl>
<dl class="section user"><dt></dt><dd>Modifying the matrix,</dd></dl>
<p class="formulaDsp">
\[ P = \begin{pmatrix} d.aspect &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; d &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; A &amp; B \\ 0 &amp; 0 &amp; -1 &amp; 0 \end{pmatrix} \]
</p>
<dl class="section user"><dt></dt><dd>\(d = 1 / \mathrm{tan}{\theta \over 2}\) is focal length. \(\theta\) is the field of view in Y-coordinate. The \(A\) and \(B\) are calculated as follow, </dd></dl>
<dl class="section user"><dt></dt><dd>\( \begin{pmatrix} A &amp;&amp; B \\ -1 &amp;&amp; 0 \end{pmatrix} \begin{pmatrix} z \\ 1 \end{pmatrix} = \begin{pmatrix} Az + B \\ -z \end{pmatrix} \)</dd></dl>
<dl class="section user"><dt></dt><dd>\(z = -n \Rightarrow {{-An + B} \over n} = 1 \) </dd></dl>
<dl class="section user"><dt></dt><dd>\(z = -f \Rightarrow {{-Af + B} \over f} = -1 \)</dd></dl>
<p class="formulaDsp">
\[ A = {{n+f} \over {f-n}} \qquad B = {{2nf} \over {f-n}} \]
</p>
<p> 
<a class="next-article-link" href="math_lighting.html">
Next: Lighting Model
</a>
 </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="transform.html">Transforming Objects To The Screen</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
